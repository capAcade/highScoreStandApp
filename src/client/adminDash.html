<!doctype html>
<html lang="en">
    <head>
            <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

            <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    </head>
        <body>


        <div class="container-fluid">
                <h1>The ugly admin dashboard</h1>
                <p>This admin dashboard does just do what it suppost to do. nothing fancy it just works!</p>
                        <div class="row">
                          <div class="col-sm">
                                <h2>some cool buttonz</h2>
                                <button type="button" class="btn btn-primary btn-lg" id="resetGame">reset game</button>
                                <button type="button" class="btn btn-success btn-lg" id="startGame">start game</button>
                          </div>
                          <div class="col-sm">
                                <h2>sendEvent</h2>
                                <div class="btn-group" role="group" aria-label="Basic example">
                                    <button type="button" id="pokeMaster" class="btn btn-secondary">add pokeMaster</button>
                                    <button type="button" id="mashdamman" class="btn btn-secondary">add mashdamman</button>
                                    <button type="button" id="bugganator" class="btn btn-secondary">add the bugganator</button>
                                    <button type="button" id="SamuraiJack" class="btn btn-secondary">add Samurai jack</button>
                                </div>
                                    
                                <form>
                                    <div class="form-group">
                                    <label for="scoreInput">score</label>
                                    <input type="number" class="form-control" id="scoreInput" placeholder="0">
                                    </div>
                                    <div class="form-group">
                                    <label for="playerSelect">player</label>
                                    <select class="form-control" id="playerSelect">
                                        <option>empty</option>
                                    </select>
                                    </div>
                                    <button type="button" class="btn btn-success btn-lg" id="updateScore">Update score</button>
                                </form>
                          </div>
                          <div class="col-sm">
                                <strong>connection websocket is<span id="statusSocket">unknown</span></strong>

                                <div>
                                        <h2>active players:</h2>
                                        <div>
                                            <ul id="activePlayersList">
                                                <li>player one</li>
                                                <li>player two</li>
                                                <li>player three</li>
                                                <li>player four</li>
                                            </ul>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h2>current data:</h2>
                                        <div>
                                            <ul id="currentData">
                                                <li>player one</li>
                                                <li>player two</li>
                                                <li>player three</li>
                                                <li>player four</li>
                                            </ul>
                                        </div>
                                    </div>
                          </div>
                        </div>
                      </div>
  



</body>

<script>

var addPokeMasterButton = document.querySelector('#pokeMaster');
var addMashdammanButton = document.querySelector('#mashdamman');
var addBugganatorButton = document.querySelector('#bugganator');
var addSamuraiJackButton = document.querySelector('#SamuraiJack');


var scoreInput = document.querySelector('#scoreInput');
var playerSelect = document.querySelector('#playerSelect');

var resetGameButton = document.querySelector('#resetGame');
var startGameButton = document.querySelector('#startGame');
var updateScore = document.querySelector('#updateScore');

var activePlayersList = document.querySelector('#activePlayersList');
var currentData = document.querySelector('#currentData');
var eventObject = document.querySelector('#eventObject');
var statusSocket = document.querySelector('#statusSocket');

var playerSelect = document.querySelector('#playerSelect');

const url = 'ws://localhost:8081/'
const connection = new WebSocket(url)

var ranking;
var activePlayers;

connection.onopen = () => {
  console.log('open');
  statusSocket.innerHTML = 'open';
}

connection.onerror = error => {
  statusSocket.innerHTML = 'error';
  console.log(`WebSocket error: ${error}`)
}

connection.onmessage = e => {
    let data = JSON.parse(e.data);
    console.log(data);
    ranking = data.ranking;
    activePlayers = data.activePlayers;

    currentData.innerHTML ='';
    activePlayersList.innerHTML = '';
    playerSelect.innerHTML = '';

    ranking.forEach(element => {
        currentData.innerHTML = currentData.innerHTML + `<li>nickname: ${element.nickName} score: ${element.score} email: ${element.email}</li>` 
        playerSelect.innerHTML = playerSelect.innerHTML + `<option value="${element.nickName}">${element.nickName}</option>`;
    });

    activePlayers.forEach(element => {
        activePlayersList.innerHTML = activePlayersList.innerHTML + `<li>nickname: ${element.player.nickName} score: ${element.player.score} email: ${element.player.email}</li>`
    });
}

updateScore.addEventListener("click", function(e){
    e.preventDefault();
    connection.send(`{"eventName": "updatePlayerScore", "player": {"nickName": "${playerSelect.value}", "score":${scoreInput.value} }}`);
});

startGameButton.addEventListener("click", function(e){
    e.preventDefault();
    connection.send('{"eventName": "startGame"}');
});

resetGameButton.addEventListener("click", function(e){
    e.preventDefault();
    connection.send('{"eventName": "resetGame"}');
});








addPokeMasterButton.addEventListener("click", function(e){
    e.preventDefault();
    connection.send('{"eventName": "addNewPlayer", "player": {"nickName": "pokeMaster","fullName": "ash ketchum", "email": "ash.ketchum@gmail.com"}}');
});
addMashdammanButton.addEventListener("click", function(e){
    e.preventDefault();
    connection.send('{"eventName": "addNewPlayer", "player": {"nickName": "mashdamman","fullName": "molly malone", "email": "molly.malone@gmail.com"}}');
});
addBugganatorButton.addEventListener("click", function(e){
    e.preventDefault();
    connection.send('{"eventName": "addNewPlayer", "player": {"nickName": "bugganator","fullName": "natalia zwamata", "email": "natalia.zwamata@gmail.com"}}');
});
addSamuraiJackButton.addEventListener("click", function(e){
    e.preventDefault();
    connection.send('{"eventName": "addNewPlayer", "player": {"nickName": "samurai jack","fullName": "hosi san", "email": "hosi.san@gmail.com"}}');
});





</script>

</html>